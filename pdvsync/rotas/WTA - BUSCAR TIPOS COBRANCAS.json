{
  "tabela": {
    "nome": "PCINTEGRACAOROTASERVICO",
    "campos": [
      {
        "nome": "SOMENTEATUALIZARINTEGRACAOCORE",
        "valor": "N"
      },
      {
        "nome": "ID",
        "valor": "WTA - Buscar tipos cobrancas"
      },
      {
        "nome": "IDEMPRESAAPI",
        "valor": "WINTHOR-WTA"
      },
      {
        "nome": "SERVICO",
        "valor": "WTA - Buscar tipos cobrancas"
      },
      {
        "nome": "LAYOUTCOMUNICACAO",
        "valor": {
          "name": "WTA - Buscar tipos cobran√ßas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{TOKEN}}"
              },
              {
                "key": "Accept",
                "value": "*/*"
              }
            ],
            "url": {
              "raw": "{{URL_BASE}}/winthor/venda/v0/tipos-cobrancas",
              "query": [
                {
                  "key": "tamanho",
                  "value": "{{PAGE_SIZE}}"
                },
                {
                  "key": "pagina",
                  "value": "{{PAGE}}"
                },
                {
                  "key": "dataUltimaAlteracao",
                  "value": "{{LAST_CHANGE}}"
                }
              ]
            }
          },
          "response": []
        }
      },
      {
        "nome": "LAYOUTTRANSFORMACAO",
        "valor": [
          {
            "operation": "default",
            "spec": {
              "items[]": {
                "*": {
                  "codOperadoraCartao": "cartao_null"
                }
              }
            }
          },
          {
            "operation": "modify-overwrite-beta",
            "spec": {
              "items": {
                "*": {
                  "codigoFiscal": "@(1,codCobSefaz)",
                  "codigoSistemaExterno": "@(1,id)",
                  "descricao": "=concat(@(1,id),' - ',@(1,cobranca))",
                  "descricaoCobSefaz": "@(1,descricaoCobSefaz)",
                  "descricaoFiscal": "@(1,cobranca)",
                  "formaPagtoModeloFiscal": [],
                  "id": "=toUpper",
                  "id_verifica_troco": "@(1,id)",
                  "idExterno": "=concat('pdvsync-cobranca-', @(1,id),'-',@(1,dataAtualizacao))",
                  "idRetaguarda": "@(1,codCobSefaz)",
                  "idRetaguardaFormaPagto": "@(1,id)",
                  "modelofiscal1": "1",
                  "modelofiscal2": "2",
                  "situacao1": "1",
                  "situacao2": "1",
                  "valorMinimoPedido": "=join(',',@(1,valorMinimoPedido_arr))",
                  "valorMinimoPedido_arr": "=split('\\.',@(1,valorMinimoPedido_str))",
                  "valorMinimoPedido_str": "=toString(@(1,valorMinimoPedido))"
                }
              }
            }
          },
          {
            "operation": "shift",
            "spec": {
              "items": {
                "*": {
                  "@codCobSefaz": "items[&1].formaPagtoModeloFiscal[0].codigoFiscal",
                  "@descricaoCobSefaz": "items[&1].formaPagtoModeloFiscal[1].descricaoCobSefaz",
                  "@id": "items[&1].formaPagtoModeloFiscal[0].idRetaguardaFormaPagto",
                  "@descricaoFiscal": "items[&1].formaPagtoModeloFiscal[1].descricaoFiscal",
                  "codCobSefaz": "items[&1].formaPagtoModeloFiscal[0].idRetaguarda",
                  "codFilial": {
                    "*": {
                      "@1": "items.[&3].idProprietario"
                    },
                    "99": {
                      "#{{MASTER_ID_PROPRIETARIO}}": "items.[&3].idProprietario"
                    }
                  },
                  "codigoFiscal": "items[&1].formaPagtoModeloFiscal[1].codigoFiscal",
                  "codigoSistemaExterno": "items.[&1].codigoSistemaExterno",
                  "codOperadoraCartao": {
                    "cartao_null": {
                      "@(2,id)": {
                        "*": {
                          "#0": "items.[&5].tipo"
                        },
                        "CH": {
                          "#4": "items.[&5].tipo"
                        },
                        "CH*": {
                          "#4": "items.[&5].tipo"
                        },
                        "D": {
                          "#1": "items.[&5].tipo"
                        },
                        "DH": {
                          "#1": "items.[&5].tipo"
                        },
                        "PIX": {
                          "#8": "items.[&5].tipo"
                        },
                        "PIX*": {
                          "#8": "items.[&5].tipo"
                        },
                        "TR": {
                          "#0": "items.[&5].tipo"
                        }
                      }
                    }
                  },
                  "descricao": "items.[&1].descricao",
                  "cobranca": "items[&1].formaPagtoModeloFiscal[0].descricaoFiscal",
                  "descricaoCobSefaz": "items[&1].formaPagtoModeloFiscal[0].descricaoCobSefaz",
                  "id": {
                    "*": {
                      "@1": "items.[&3].idRetaguarda"
                    },
                    "CRED": {
                      "#4": "items.[&3].tipoCliente",
                      "#CRED": "items.[&3].idRetaguarda"
                    }
                  },
                  "id_verifica_troco": {
                    "CH*": {
                      "#1": "items.[&3].permiteTroco",
                      "#TR": "items.[&3].idRetaguardaFormaPagTroco"
                    },
                    "D": {
                      "#1": "items.[&3].permiteTroco",
                      "#TR": "items.[&3].idRetaguardaFormaPagTroco"
                    },
                    "DH": {
                      "#1": "items.[&3].permiteTroco",
                      "#TR": "items.[&3].idRetaguardaFormaPagTroco"
                    }
                  },
                  "idExterno": "items.[&1].idExterno",
                  "idRetaguarda": "items[&1].formaPagtoModeloFiscal[1].idRetaguarda",
                  "idRetaguardaFormaPagto": "items[&1].formaPagtoModeloFiscal[1].idRetaguardaFormaPagto",
                  "modelofiscal1": "items[&1].formaPagtoModeloFiscal[0].modeloFiscal",
                  "modelofiscal2": "items[&1].formaPagtoModeloFiscal[1].modeloFiscal",
                  "nivelvenda": {
                    "*": {
                      "#1": "items.[&3].situacao"
                    },
                    "0": {
                      "#0": "items.[&3].situacao"
                    }
                  },
                  "operadoras": {
                    "*": {
                      "#1": "items.[&3].formasPagtoOperadoras[&1].situacao",
                      "codcob": [
                        "items.[&3].formasPagtoOperadoras[&1].idRetaguarda",
                        "items.[&3].formasPagtoOperadoras[&1].idRetaguardaFormaPagto",
                        "items.[&3].formasPagtoOperadoras[&1].idRetaguardaOperadoraPagto"
                      ],
                      "tipoOperacaoTef": {
                        "codTipoTef": {
                          "*": {
                            "#0": "items.[&6].tipo"
                          },
                          "01": {
                            "#3": "items.[&6].tipo",
                            "#true": "items.[&6].isCard"
                          },
                          "02": {
                            "#2": "items.[&6].tipo",
                            "#true": "items.[&6].isCard"
                          }
                        }
                      }
                    }
                  },
                  "planoPagamentos": {
                    "*": {
                      "@(2,id)": "items.[&3].formasPagtoCondicoes[&1].idRetaguardaFormaPagto",
                      "codigo": "items.[&3].formasPagtoCondicoes[&1].idRetaguardaCondicaoPagto",
                      "idRetaguarda": "items.[&3].formasPagtoCondicoes[&1].idRetaguarda"
                    }
                  },
                  "situacao1": "items[&1].formaPagtoModeloFiscal[0].situacao",
                  "situacao2": "items[&1].formaPagtoModeloFiscal[1].situacao",
                  "valorMinimoPedido": "items.[&1].valorMinimoAceito"
                }
              }
            }
          },
          {
            "operation": "shift",
            "spec": {
              "items": {
                "*": {
                  "@": "items[&1][0]",
                  "isCard": {
                    "true": {
                      "#5": "items[&3][1].tipo",
                      "@(2,codigoSistemaExterno)": "items[&3][1].codigoSistemaExterno",
                      "@(2,descricao)": "items[&3][1].descricao",
                      "@(2,descricaofiscal)": "items[&3][1].descricaofiscal",
                      "@(2,formasPagtoCondicoes)": {
                        "*": {
                          "idRetaguarda": "items[&5][1].formasPagtoCondicoes[&1].idRetaguarda",
                          "idRetaguardaCondicaoPagto": "items[&5][1].formasPagtoCondicoes[&1].idRetaguardaCondicaoPagto",
                          "idRetaguardaFormaPagto": "items[&5][1].formasPagtoCondicoes[&1].idRetaguardaFormaPagto"
                        }
                      },
                      "@(2,formasPagtoOperadoras)": {
                        "*": {
                          "idRetaguarda": "items[&5][1].formasPagtoOperadoras[&1].idRetaguarda",
                          "idRetaguardaFormaPagto": "items[&5][1].formasPagtoOperadoras[&1].idRetaguardaFormaPagto",
                          "idRetaguardaOperadoraPagto": "items[&5][1].formasPagtoOperadoras[&1].idRetaguardaOperadoraPagto",
                          "situacao": "items[&5][1].formasPagtoOperadoras[&1].situacao"
                        }
                      },
                      "@(2,idExterno)": "items[&3][1].idExterno",
                      "@(2,idProprietario)": "items[&3][1].idProprietario",
                      "@(2,idRetaguarda)": "items[&3][1].idRetaguarda",
                      "@(2,situacao)": "items[&3][1].situacao"
                    }
                  }
                }
              }
            }
          },
          {
            "operation": "shift",
            "spec": {
              "items": {
                "*": {
                  "0": {
                    "@": "items[]"
                  },
                  "1": {
                    "@": "pos[]"
                  }
                }
              }
            }
          },
          {
            "operation": "default",
            "spec": {
              "_attr_access": "items",
              "pos[]": {
                "*": {
                  "formasPagtoDadosComplementares": [
                    {
                      "idRetaguardaDadoComplementarPagto": "11",
                      "ordem": 0,
                      "situacao": 1
                    },
                    {
                      "idRetaguardaDadoComplementarPagto": "12",
                      "ordem": 1,
                      "situacao": 1
                    }
                  ]
                }
              }
            }
          },
          {
            "operation": "modify-overwrite-beta",
            "spec": {
              "pos": {
                "*": {
                  "descricao": "=concat(@(1,descricao),' - POS')",
                  "formasPagtoCondicoes": {
                    "*": {
                      "idRetaguarda": "=concat(@(1,idRetaguarda),'-POS')",
                      "idRetaguardaFormaPagto": "=concat(@(1,idRetaguardaFormaPagto),'-POS')"
                    }
                  },
                  "formasPagtoDadosComplementares": {
                    "*": {
                      "idRetaguarda": "=concat(@(1,idRetaguardaDadoComplementarPagto),'-',@(3,idRetaguarda))",
                      "idRetaguardaFormaPagto": "@(3,idRetaguarda)"
                    }
                  },
                  "formasPagtoOperadoras": {
                    "*": {
                      "idRetaguarda": "=concat(@(1,idRetaguarda),'-POS')",
                      "idRetaguardaFormaPagto": "=concat(@(1,idRetaguardaFormaPagto),'-POS')"
                    }
                  },
                  "idExterno": "=concat(@(1,idExterno),'-POS')",
                  "idRetaguarda": "=concat(@(1,idRetaguarda),'-POS')"
                }
              }
            }
          },
          {
            "operation": "shift",
            "spec": {
              "items": {
                "*": {
                  "@": "items[]",
                  "idExterno": "idExterno[]"
                }
              },
              "pos": {
                "*": {
                  "@": "items[]",
                  "idExterno": "idExterno[]"
                }
              }
            }
          },
          {
            "operation": "default",
            "spec": {
              "_attr_access": "items",
              "items[]": {
                "*": {
                  "idInquilino": "{{ID_INQUILINO}}",
                  "idProprietario": "{{MASTER_ID_PROPRIETARIO}}",
                  "loteOrigem": "{{LOTE_ORIGEM}}",
                  "permiteTroco": 0,
                  "situacao": 0,
                  "valorMinimoAceito": 0
                }
              }
            }
          }
        ]
      },
      {
        "nome": "ATIVO",
        "valor": "S"
      },
      {
        "nome": "AUTENTICADOR",
        "valor": "N"
      },
      {
        "nome": "DATASINCRONISMO",
        "valor": "14-NOV-23"
      },
      {
        "nome": "REFRESHTOKEN",
        "valor": ""
      },
      {
        "nome": "TIPOPROCESSO",
        "valor": "BUSCAR"
      }
    ]
  }
}
